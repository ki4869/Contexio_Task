package writeexcel;

import java.io.FileOutputStream;
import java.util.Scanner;

import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class writeexcel {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		XSSFWorkbook workbook = new XSSFWorkbook();

		// Create a Sheet
		Sheet sheet = workbook.createSheet("Sheet1");

		Scanner sc = new Scanner(System.in);
		
		Row headerRow = sheet.createRow(0);  //heading for excel file
        headerRow.createCell(0).setCellValue("empid");
        headerRow.createCell(1).setCellValue("empname");
        headerRow.createCell(2).setCellValue("empphoneno");


		System.out.println("Enter data for Excel file");
		int rowCount = 1;
		while (true) {
			System.out.print("Enter EmployeeID: ");
			String empId = sc.next();

			System.out.print("Enter EmployeeName: ");
			String empName = sc.next();

			System.out.print("Enter Employee PhoneNumber: ");
			String empPhone = sc.next();
			

	        System.out.print("Enter Employee Date of Birth (MM/dd/yyyy): ");
	         String empDOB = sc.next();

	         System.out.print("Enter Employee Email: ");
	         String empEmail = sc.next();

			Row row = sheet.createRow(rowCount++);
			row.createCell(0).setCellValue(empId);
			row.createCell(1).setCellValue(empName);
			row.createCell(2).setCellValue(empPhone);
			row.createCell(3).setCellValue(empDOB);
            row.createCell(4).setCellValue(empEmail);
			
			
			

		try{
			FileOutputStream outputStream = new FileOutputStream("D:\\exceldata\\output.xlsx"); 
			workbook.write(outputStream);
			System.out.println("Data written successfully");

			System.out.print("Do you want to add more data? (Y/N): ");
            String choice = sc.next();
            if (!choice.equalsIgnoreCase("Y")) {
                break;
            }
			
			
			

		} catch (Exception e) {
			e.printStackTrace();
		}
		finally {
			sc.close();
		}

		try {
			 workbook.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

}}
